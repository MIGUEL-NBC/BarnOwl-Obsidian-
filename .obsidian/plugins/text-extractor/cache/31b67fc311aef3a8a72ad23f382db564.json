{"path":"Referenced Material/Reference Library/Vendor/Evertz/SDVN Training/19 - Timing and inSITE SDVN Course Updated 101818.pdf","text":"Company Confidential Timing & ≡inSITE Module 19 Company Confidential ▪ Genlock Reference (Black Burst, Bi/Tri-level) ▪ Genlock is sent to the frames and frame controllers just as it always has been Synchronizing the IP Facility Company Confidential ▪ PTP/PCR Timing ▪ PCR or PTP is sent to the EXE to be distributed via the 10G network to all the edge devices • Whether PRC or PTP is sent will be determined based on what format is being sent ST2110 or ASPEN Synchronizing the IP Facility 3Company Confidential ▪ In the IP broadcast environment timing is handled using the 5700MSC-IP. ▪ This device will be used to generate the timing data and then transmit PCR/PTP to the rest of the system. ▪ It will also produce IP test gen signals in any of the required formats • i.e. ASPEN, ST 2110 etc How Is Timing Handled? 4Company Confidential ▪ PTP will always be provided to the system through the Time port of the MSC ▪ PTP is sent directly to Evertz edge devices that are using the SMPTE 2110 standard • If the edge devices are using ASPEN then it is not sent directly to the edge devices, it is used to create a PCR signal • PCR became a requirement as devices began to no longer use bi-level reference ▪ PTP cannot be sent unless the MSC is locked to GPS • There is an option to generate PTP from the video reference but it is being phased out ▪ The more hops the PTP takes between the MSC and the destination the more jittery it becomes Understanding PTP 5Company Confidential ▪ PTP stands for Precise Time Protocol ▪ PTP contains 3 types of messages • Announce: this is a message to the PTP domain describing its attributes • It contains Clock ID, Priority 1, Clock Class, Clock Accuracy, Clock Variance, Priority 2 • These values are used to determine who wins in the BMCA • Sync: time stamped message which includes the Delay Request, Delay Response and PTP Time • Management ▪ PTP delivers time and frequency through a reference multicast • This multicasts IP is 224.0.1.129 which is not a value that we can change Understanding PTP Company Confidential ▪ There are multiple PTP Profiles available to use ▪ They define parameters and limits around the frequency of announce and sync messages • Default: Annex J is the minimum spec for PTP • 2059-2 Profile: SMPTE standard for Broadcast required for PTP timing • This has a larger range of frequencies for announce and sync messages • The range helps to minimize the amount of drift between sync messages • Allows a sync rate of up to 128 per second, but this is best only in a small system with a low number of clocks • Allows an announce rate of up to 8 per second and reconvergence when master/grand master disappears • AVB Profile PTP Profiles Company Confidential ▪ PCR stands for Program Clock Reference ▪ PCR functions in the same manner as Bi-Level Reference ▪ PCR is used to send PTS to every device, this will ensure that all the signals have matching PTS stamps in the header of the packet on encapsulation before being sent through the IP core • If audio and video are to be combined from unique devices and don’t have matching PTS stamps then the data cannot be combined cleanly and cause either ticking or popping ▪ PCR is what drives the frame buffer ▪ PCR is transmitted in the adaptation field of an MPEG-2 TS packet. Understanding PCR 8 SDI Sync ENC ENCAP VIDEO AUDIO PTS Stamping PCR ENC ENCAP DEC DE-ENCAP Line Buffer/ Frame Buffer SDI PCR PCR ROUTER Company Confidential Understanding PTS 9 Bi-Level Ref Video 1 Audio 1 ANC 1 SDI IP ENCAP 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 Video Audio ANC Video 2 Audio 2 ANC 2 SDI IP ENCAP 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 Video Audio ANC 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 Bi-Level Ref ▪ PTS stands for Program Time Stamp which is generated by each device individually on power up ▪ PTS is taken from the PCR signal and used to ensure each device has the same PTS stamp as opposed to each device using the one it generates itself. Company Confidential Understanding PTS 10 Bi-Level Ref Video 1 Audio 1 ANC 1 SDI IP ENCAP GMP PCR 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 Video Audio ANC GMP PTS 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 Company Confidential Understanding PTS 11 Bi-Level Ref Video 1 Audio 1 ANC 1 SDI IP ENCAP GMP PCR GMP PTS 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 Video Audio ANC 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 Company Confidential ▪ The 5601MSC Master Sync and Clock Generator is a broadcast quality master sync pulse generator and a master clock. ▪ The 5601 utilizes a high stability, temperature controlled oscillator to provide better than 1.0x10-8 (or 0.01ppm) frequency reference ▪ the free running drift is less than 0.1Hz which amounts less than one millisecond time drift per day ▪ The SPG section of the MSC provides 6 timeable reference outputs, which can provide independently times colour black burst outputs or HDTV tri-level sync outputs 5601MSC 12Company Confidential ▪ 6 independently timeable programmable reference outputs ▪ Bi-level or Tri-level output selectable ▪ 2 independent LTC Time Code outputs & LTC input ▪ Reference loop input for video and 10MHz/5MHz references ▪ GPS option for frequency and time reference (required for PTP) ▪ SNTP option for time reference ▪ 2 GPS based units will be in time and phase even when remotely separated by miles ▪ Test Generators available are: • Composite Video • AES/DARS • Analog Audio Tones • SD/HD/3G SDI ▪ PTP/IEEE-1588 master support ▪ Automatic Changeover units available for redundant systems 5601MSC Features & Benefits 13Company Confidential ▪ The 5600GMP Grand Master Proxy (Boundary Clock) is capable of referencing an IEEE-1588 (PTP) clock and acting as the master clock for downstream devices in AVB profile ▪ The use of proxies (Boundary Clocks) reduces the delay request message load on the grand master clock ▪ Time reference in slave mode of 1588 is acquired on its upstream PTP port and the reference to other devices is provided on the downstream port ▪ The GMP utilizes a high stability, temperature controlled oscillator to provide better than 1.0x10-8 (or 0.01ppm) frequency reference 5600GMP 14Company Confidential ▪ Reference input for video references ▪ 16 character Alpha-numeric display ▪ Rack mountable ▪ Optional redundant power supply ▪ VistaLINK control for device configuration and status monitoring ▪ High performance CPU dedicated to PTP and AVB processing ▪ Supports IEEE-1588 protocol slave mode ▪ Free running drift less than 0.1Hz (less than 1 millisecond time drift per day) 5600GMP Features & Benefits 15Company Confidential ▪ The 5700MSC-IP combines both Master Clock functionality and Grand Master Proxy functionality into a 1RU form factor ▪ The 5700MSC utilizes IEEE-1588 and will also have support for SMPTE 2059-2 in the future ▪ Supports for PTP, NTP, PCR and AVB ▪ 6 IP test generator signals on two 10G outputs ▪ 4 SDI test signals ▪ Loop through reference input 5700MSC-IP 16Company Confidential ▪ 5700-AUX is an add-on board for the 5700MSC-IP ▪ It provides additional aux legacy output standards ▪ This board is programmed by the other boards in the frame and does not have its own CPU ▪ The 5700-AUX adds: • AES.DARS outputs as both balanced and unbalanced • 2 additional sync ports (10MHZ/WORDCLOCK) • 2 balanced LTC outputs • Balanced LTC input • 2 GPOs and 2 GPIs on the HD15 connector • 2 balanced analog audio outputs on the terminal block 5700-AUX Company Confidential ▪ The Sync, reference loop and SDI test generator signals are provided with mini BNC connectors ▪ PTP and PC can also be supplied on all of the 1G connections ▪ 10G connections provide PTP, PCR and IP test generator signals 5700MSC-IP Rear Plate Details 18Company Confidential 5601MSC + 5600GMP Environment 19 SPG Main SPG Backup ACO BMCA B/C GPS GPS SPG Main COTS COTS 5600GMP 5600GMP Sync PTP PTP U/P U/P PCR D/S PCR D/S Lock Type P1 P2 MAC COTS SLCompany Confidential 5700 Environment 20 5700 5700 ACO COTS CLOUD GPS GPS PTP PTP 1G 1G10G 10G PCR PTP PCR PTP Company Confidential ▪ PTP and PCR are generated in the 5700MSC as it exists in the SPG ▪ PCR connects directly into the IP core (EXE, IPX etc) from the GMP ▪ The signal type each MSC locks to determines who is master and who is slave • The MSC which is GPS locked will always be master ▪ BMCA is still used to determine which MSC is the best to lock to for Master ▪ Each SPG will use the same Sync ▪ Ensure the GMP enable flag has been set System Timing 21Company Confidential ▪ In a system with multiple Master Clocks and sending the BMCA through a COTS switch: • it must be able to do multicast routing for the BMCA to work properly • All announce messages from the MSC will be received simultaneously • The COTS switch must be a layer 2 switch especially if utilizing multiple GMP’s ▪ This could be solved by adding either a Boundary Clock or a Transparent Clock ▪ The master MSC sends the Sync, the slave MSC receives it and sends back the Delay Request System Timing Continued 22Company Confidential ▪ Ordinary Clock: has 1 time interface (master or slave) i.e. 5601MSC ▪ Boundary Clock: has 2 or more time interfaces, one is always a slave and all others are masters • A boundary clock ahs a clock who’s master is above it ▪ Transparent Clock: special kind of Ethernet switch that measures the time it takes PTP to enter and leave the switch • the measurement will be used to adjust the Sync Message in the Correction Field • Transparent clocks don’t work if they are connecting to PTP slaves that don’t know how to handle the correction fields Clocks Company Confidential ▪ On each 5700MSC-IP connect the following: • Connect the Control Network Port on the frame to the Management Network or the Control network • Connect one of the 10G ports to the EXE • Connect on of the 1G ports to the Control network • Connect the Sync and Test Generator mini BNC’s to the 5601ACO2 Configuring the System Timing 24 Content Network (EXE) GPS Management NetworkSync 1Ref In Ref Loop Teriminated Gateway CTRL = 10.190.190.241 5700MSC: 10.190.190.250FC: 10.190.190.253 FC: 10.190.190.254 10.190.190.236 10.190.190.228 5700MSC in GMP Mode: 10.190.190.251 GPS Company Confidential ▪ Set the following values to ensure the BMCA works as desired: • Priority 1: these values should match on both clocks • Clock Class: this will come from being locked to GNSS, nothing to be set • Clock Accuracy: this will come from the type of device it is, nothing to be set • Clock Variance: this will be generated by the oscillator accuracy and frequency, nothing to be set • Priority 2: the main unit should have a value lower than the second unit (i.e. Main unit Priority 2 = 1 and Backup unit Priority 2 = 2) • MAC Address: if all the above values are a match then the system will use the lower MAC address Setting the Values for the MSC Company Confidential ▪ The only real way to troubleshoot timing problems is to figure out what works in the system and trace the PCR/PTP through the system ▪ Combining a Locked signal and an Unlocked signal: • This will cause ticking on the output ▪ ≡inSITE will have timing graphs for the system added into the graphical portion • It will need to connect to the PTP signal as close as possible (i.e. minimizing the number of hops between ≡inSITE and the MSC) ▪ NEVER reboot during troubleshooting as you will alter the problem that exists and add variables Troubleshooting Timing Problems 26Company Confidential ▪ Add the 5700MSC-IP to Magnum-SDVN under Device and Links ▪ Add the following values for the General Settings: • Primary IP: this will be the IP of the frame controller • Priority2: this will be the Priority2 value set for the MSC on the front panel • Ethernet 3: this will be the IP address assigned to the data port Routing PTP Using SDVN Company Confidential ▪ Create a link from the 5700MSC-IP to the core device it is connected to ▪ Open the Admin configuration shell and route the PTP: • Navigate to Magnum Tools > Set Static Routes • Run the script, this will create both the Inband Control routes as well as the PTP routes Routing PTP Using SDVN Company Confidential ▪ Why do we need Big Data Analytics? • Transition to IP networks continues to evolve and grow, • With this evolution comes the need for specialized tools to be able to troubleshoot and diagnose these networks grows too • Need to be able to gather information of every network element, what they are doing and how they are performing at all times ▪ Big data is the data that is obtained from your system ≡inSITE – Big Data Analytics Company Confidential ▪ Utilized by both Evertz service and customers ▪ Allows for the capturing and index of many different forms of device data at a high velocity ▪ Normalizes collected, disparate unstructured data to make it easy to work with and search through ▪ Helps users sport trends, patterns and anomalies in the data sets ▪ Supports a number of external notification systems such as SNMP (VLPRO), email, PagerDuty, Slack and Jira ≡inSITE Company Confidential ≡inSITE Functional Overview Company Confidential ▪ What Data Is Collected by ≡inSITE? • Syslog • SNMP • LLDP • Windows Event Logs • Generic Structured Data • Metrics ▪ ≡inSITE is not a replacement for VLPro as they perform 2 very unique functions • ≡inSITE collects the data and allows for better analytics of what is happening • ≡inSITE can also send this data to VLPro so that proper notifications can be sent • VLPro is used for notification of an issue primarily ≡inSITE • Note/Incidents • Operating System • Generic Text/Log File •EXE Port/Flow Data •Synergy Protocol •Magnum Protocol","libVersion":"0.3.1","langs":""}